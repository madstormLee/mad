<h1><?=_("Category")?></h1>

<p id='console' class='notice'></p>

<nav class='component'>
	<a class='write' href='./write'><?=_("Create Category")?></a>
</nav>

<section id='CategoryIndex' class='treeContainer' >
	<section class='tree subs'>
	<? $categoryIterator = function( $category ) use ( &$categoryIterator ) { ?>
	<? foreach( $category as $row ): ?>
	<dl>
		<dt>
		<form class='row' method='post' action='./save'>
			<? if ( ! empty( $row->subs ) ): ?>
			<a class='toggle hasSubs' href='#toggleSub' title='toggle sub category'>+</a>
			<? else: ?>
			<a class='toggle' href='#toggleSub' title='no sub category'>-</a>
			<? endif; ?>
			<input type='hidden' class='id' name='id' value='<?=$row->id?>' />
			<input type='hidden' class='ordernumber' name='ordernumber' id='ordernumber<?=$row->id?>' value='<?=$row->ordernumber?>' />
			<input type='text' class='label' name='label' id='label<?=$row->id?>' value='<?=$row->label?>' placeholder='<?=_("input category name")?>' title='<?=_("category name")?>' required='required' />
			( <a class='items' href='~/itemLocale/list?id=<?=$row->id?>' title='item list'><?=$row->count?></a> )
			<input type='checkbox' name='isopen' id='isopen<?=$row->id?>' value='<?=$row->isopen?>' <?=( $row->isopen )? "checked='checked'": ""; ?> title='<?=_("is opened")?>' />
			<a class='createSub' href='./write?parentid=<?=$row->id?>' title='<?=_("create sub")?>'><?=_("create sub")?></a>
			<a class='delete' href='./delete?id=<?=$row->id?>' data-confirm='<?=_("delete category")?>'><?=_("delete")?></a>
			<nav class='position'>
				<a class='merge' href='./merge?id=<?=$row->id?>' title='<?=_("merge with...")?>'><?=_("merge")?></a>
				<a class='moveUp' href='./moveUp?id=<?=$row->id?>' title='<?=_("order up")?>'><?=_("up")?></a>
				<a class='moveDown' href='./moveDown?id=<?=$row->id?>' title='<?=_("order down")?>'><?=_("down")?></a>
			</nav>
		</form>
		</dt>
		<? if ( ! empty( $row->subs ) ): ?>
		<dd class='subs'><? $categoryIterator( $row->subs ); ?></dd>
		<? endif; ?>
	</dl>
	<? endforeach; ?>
	<? }; $categoryIterator( $category ); ?>
	</section>

	<nav class='buttons'>
		<button type='submit'><?=_("저장")?></button>
		<button type='reset'><?=_("초기화")?></button>
	</nav>
</section>
