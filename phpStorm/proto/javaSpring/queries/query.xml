<?='<?xml version="1.0" encoding="UTF-8"?>'?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="<?=$scheme->getName()?>">	
	<insert id="insert" parameterClass="map">
		<selectKey keyProperty="id" resultClass="String">	
			SELECT <?=$scheme->getTable()?>_SEQUENCE.NEXTVAL FROM DUAL
		</selectKey>				
		INSERT INTO <?=$scheme->getTable()?> 
		 ( <?=$scheme->getFields()?> )
		VALUES
		 ( <?=$scheme->getValues()?> )
	</insert>				
	<update id="update"  parameterClass="map">
		UPDATE <?=$scheme->getTable()?> 
		SET <?=$scheme->getUpdateSet()?> 
		WHERE "SEQ" = #seq#		
	</update>

	<delete id="delete" parameterClass="map">
		DELETE FROM <?=$scheme->getTable()?> 
		WHERE  "SEQ" = #seq#					 
	</delete>
	
	<select id="getMap" parameterClass="map" resultClass="hmap">
		SELECT <?=$scheme->getFields()?> 
 		FROM    <?=$scheme->getTable()?> 
		WHERE  "SEQ" = #seq# 
	</select>

	<select id="getList" parameterClass="map" resultClass="hmap">
	SELECT * FROM
	(
		SELECT <?=$scheme->getFields()?> 
		FROM    <?=$scheme->getTable()?> 
		ORDER BY "SEQ" DESC
	)
	WHERE 1=1
	<isNotEmpty property="page_start">
		<isNotEmpty prepend="AND" property="page_end">
		BETWEEN #page_start# AND #page_end#
		</isNotEmpty>
	</isNotEmpty>

<? foreach( $scheme->getConfig()->columns as $name => $column ): ?>
<? if ( $name == 'no' ) $name = 'id' ?>
	<isNotEmpty prepend="AND" property="<?=strToLower($name)?>" >	
		"<?=strToUpper($name)?>" like '%' || #<?=strToLower($name)?># || '%'
	</isNotEmpty>
<? endforeach; ?>

	</select>

	<select id="getListCnt" resultClass="int" >
	SELECT COUNT(*)	        
	FROM   <?=$scheme->getTable()?> 
	WHERE 1=1
<? foreach( $scheme->getConfig()->columns as $name => $column ): ?>
<? if ( $name == 'no' ) $name = 'id' ?>
	<isNotEmpty prepend="AND" property="<?=strToLower($name)?>" >	
		"<?=strToUpper($name)?>" like '%' || #<?=strToLower($name)?># || '%'
	</isNotEmpty>
<? endforeach; ?>
	</select>	

</sqlMap>
